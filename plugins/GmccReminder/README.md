# 政企微信提醒机器人使用指南

## 功能概述
本机器人提供群聊中的任务管理功能，支持：
- 调度人配置周期性任务
- 执行人标记任务完成
- 自动发送任务提醒

## 配置新任务

### 消息格式样例

#### 每日任务样例
```text
@机器人 配置事项
【事项名称】月度销账报表提交  
【事项描述】每月提交月度销账报表进行审批  
【任务调度人】张三
【任务执行人】李四，王五，赵六  
【任务周期】每日
【截止时间】12时30分  
【提前提醒次数】2
```

#### 每周任务样例
```text
@机器人 配置事项
【事项名称】月度销账报表提交  
【事项描述】每月提交月度销账报表进行审批  
【任务调度人】张三
【任务执行人】李四，王五，赵六  
【任务周期】每周
【截止时间】每周4 12时30分 
【提前提醒次数】2
```

#### 每月任务样例
```text
@机器人 配置事项
【事项名称】月度销账报表提交  
【事项描述】每月提交月度销账报表进行审批  
【任务调度人】张三
【任务执行人】李四，王五，赵六  
【任务周期】每月
【截止时间】每月20日，14时30分
【提前提醒次数】2
```

### 字段说明
| 字段            | 必填 | 格式说明                          | 示例                  |
|----------------|-----|---------------------------------|----------------------|
| 事项名称         | ✓   | 任务名称                  | 月度销账报表提交         |
| 事项描述         | ✓   | 简要说明任务内容                | 每月提交报表进行审批      |
| 任务调度人        | ✓   | 任务调度人姓名                         | 张三                  |
| 任务执行人        | ✓   | 任务执行人姓名                   | 李四，王五             |
| 任务周期         | ✓   | 每日/每周/每月                     | 每周                  |
| 截止时间         | ✓   | 根据周期类型变化（见下方说明）          | 每周4 12时30分              |
| 提前提醒次数       | ✓   | 数字                       | 2                    |

### 截止时间格式规则
- **每日任务**：`时`+`分`  
  `14时30分` → 即每天14:30截止
- **每周任务**：`周`+`星期数`+`时`+`分`  
  `每周4 14时30分` → 即每周四14:30截止
- **每月任务**：`日`+`时`+`分`  
  `每月20日，14时30分` → 即每月20日14:30截止

### 任务配置成功
在配置完成后，若任务配置成功，将会返回如下信息：

<img src="Image_README/任务配置成功.jpg" width="36%">

返回消息格式：
```text
任务配置成功！
【任务名称】月度销账报表提交
【任务描述】每月提交月度销账报表进行审批  
【任务索引号】YDXZBBTJ-iNgyRxpZ
【截止日期】2023-11-20 12:30
```

其中，任务索引号由任务名拼音首字母大写与随机字符组成。

## 标记任务完成

### 消息格式
```text
@机器人 任务完成
【完成人】李四
【事项索引】YDXZBBTJ-iNgyRxpZ
```

### 字段说明
| 字段       | 必填 | 说明                     | 示例                  |
|-----------|-----|------------------------|----------------------|
| 完成人      | ✓   | 执行人姓名                | 李四                  |
| 事项索引     | ✓   | 配置任务时返回的唯一ID       | YDXXBBTJ-iNgyRxpZ    |

### 任务完成成功
在成功收到任务完成消息，将会返回如下信息：

<img src="Image_README/任务完成成功.jpg" width="36%">

返回消息格式：
```text
完成信息更新成功
【任务索引】YDXZBBTJ-iNgyRxpZ
【完成人】李四
【剩余执行者】王五，赵六
```

## 任务提醒样例
机器人会根据`截止时间`与`提前提醒次数`进行提醒：
```text
【事项名称】月度销账报表提交
【事项索引】YDXZBBTJ-iNgyRxpZ
【事项描述】每月提交月度销账报表进行审批
【任务调度人】张三
【截止时间】2023-11-20 12:30:00
【未完成执行人】李四，王五
请尽快完成。若已完成，请 @机器人 并回复：
【完成人】你的姓名
【事项索引】事项索引
```

## 注意事项
1. 所有方括号`【】`等标点符号皆为全角符号，即拼音输入法下的输入
2. 字段间用换行符(Shift + Enter)分隔
3. 配置成功后机器人会返回任务索引（可通过拼音首字母搜索）

> 提示：可长按消息复制模板，修改字段内容后发送